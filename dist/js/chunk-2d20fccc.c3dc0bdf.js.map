{"version":3,"sources":["webpack:///./src/views/admin/Coupon.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?80f5","webpack:///./src/views/admin/Coupon.vue?b215"],"names":["class","type","openModal","coupons","item","key","id","title","percent","$filters","date","due_date","is_enabled","delModal","ref","data","tempCoupon","updateCoupon","isNew","updateDelete","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","for","placeholder","code","min","true-value","false-value","$emit","props","watch","this","Date","toLocaleDateString","Math","floor","mixins","modal","render","components","couponModal","methods","getCoupons","page","api","$http","get","then","res","success","now","$refs","httpMethod","alert","message","hideModal","catch","error","console","log","dcModal","delete","created"],"mappings":"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","file":"js/chunk-2d20fccc.c3dc0bdf.js","sourcesContent":["<template>\r\n    <div class=\"DashMain\">\r\n    <div class=\"container\">\r\n      <div class=\"text-end\">\r\n        <button type=\"button\" class=\"btn btn-primary mt-5\" @click=\"openModal(true)\">新增優惠卷</button>\r\n      </div>\r\n      <div class=\"table-responsive\">\r\n      <table class=\"table table-success table-striped table-hover mt-3\">\r\n        <thead>\r\n        <tr>\r\n          <th>名稱</th>\r\n          <th>折扣百分比</th>\r\n          <th>到期日</th>\r\n          <th>是否啟用</th>\r\n          <th class=\"text-center\">編輯</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"item in coupons\" :key=\"item.id\">\r\n          <td>{{item.title}}</td>\r\n          <td>{{item.percent}}%</td>\r\n          <td>{{ $filters.date(item.due_date)}}</td>\r\n          <td>\r\n          <span v-if=\"item.is_enabled === 1\" class=\"text-success fw-bold\">啟用</span>\r\n          <span v-else class=\"text-danger fw-bold\">停用</span>\r\n          </td>\r\n          <td class=\"text-center\">\r\n          <div class=\"btn-group\">\r\n          <button class=\"btn btn-secondary\" @click=\"openModal(false, item )\">編輯</button>\r\n          <button class=\"btn btn-danger\"  @click=\"delModal(item)\">刪除</button>\r\n          </div>\r\n          </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      </div>\r\n    </div>\r\n    <couponModal ref=\"couponModal\" :data=\"tempCoupon\" @update-coupon=\"updateCoupon\" :isNew=\"isNew\"></couponModal>\r\n    <delModal ref=\"dcModal\" :data=\"tempCoupon\" @update-delete=\"updateDelete\"></delModal>\r\n  </div>>\r\n</template>\r\n<script>\r\nimport couponModal from '@/components/CouponModal.vue'\r\nimport delModal from '@/components/DelModal.vue'\r\nexport default {\r\n  data () {\r\n    return {\r\n      coupons: [],\r\n      tempCoupon: {},\r\n      isNew: false\r\n    }\r\n  },\r\n  components: {\r\n    couponModal,\r\n    delModal\r\n  },\r\n  methods: {\r\n    getCoupons (page = 1) {\r\n      const api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/admin/coupons?${page}`\r\n      this.$http.get(api).then(res => {\r\n        if (res.data.success) {\r\n          this.coupons = res.data.coupons\r\n        }\r\n      })\r\n    },\r\n    openModal (isNew, item) {\r\n      this.isNew = isNew\r\n      if (isNew) {\r\n        this.tempCoupon = {\r\n          due_date: Math.floor(Date.now() / 1000),\r\n          is_enabled: 0,\r\n          percent: 100\r\n        }\r\n      } else {\r\n        this.tempCoupon = { ...item }\r\n      }\r\n      this.$refs.couponModal.openModal()\r\n    },\r\n    updateCoupon (item) {\r\n      let api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/admin/coupon`\r\n      let httpMethod = 'post'\r\n      if (!this.isNew) {\r\n        httpMethod = 'put'\r\n        api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/admin/coupon/${item.id}`\r\n      }\r\n      this.$http[httpMethod](api, { data: item }).then(res => {\r\n        if (res.data.success) {\r\n          alert(res.data.message)\r\n          this.getCoupons()\r\n          this.$refs.couponModal.hideModal()\r\n        } else {\r\n          alert(res.data.message)\r\n        }\r\n      }).catch(error => {\r\n        console.log(error)\r\n      })\r\n    },\r\n    delModal (item) {\r\n      this.tempCoupon = { ...item }\r\n      this.$refs.dcModal.openModal()\r\n    },\r\n    updateDelete (id) {\r\n      const api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/admin/coupon/${id}`\r\n      this.$http.delete(api).then(res => {\r\n        if (res.data.success) {\r\n          alert(res.data.message)\r\n          this.getCoupons()\r\n          this.$refs.dcModal.hideModal()\r\n        } else {\r\n          alert(res.data.message)\r\n        }\r\n      }).catch(error => {\r\n        console.log(error)\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.getCoupons()\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n  <div\r\n    class=\"modal fade\"\r\n    id=\"couponModal\"\r\n    tabindex=\"-1\"\r\n    role=\"dialog\"\r\n    aria-labelledby=\"exampleModalLabel\"\r\n    aria-hidden=\"true\"\r\n    ref=\"modal\"\r\n  >\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header bg-primary text-white\">\r\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\"></h5>\r\n          <span v-if=\"isNew\">新增優惠券</span>\r\n          <span v-else>編輯優惠券</span>\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn-close\"\r\n            data-bs-dismiss=\"modal\"\r\n            aria-label=\"Close\"\r\n          ></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"mb-3\">\r\n            <label for=\"title\">標題</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"title\" placeholder=\"請輸入標題\"\r\n            v-model=\"tempCoupon.title\"\r\n            />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"coupon_code\">優惠碼</label>\r\n            <input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              id=\"coupon_code\"\r\n              v-model=\"tempCoupon.code\"\r\n              placeholder=\"請輸入優惠碼\"\r\n            />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"due_date\">到期日</label>\r\n            <input type=\"date\" class=\"form-control\" id=\"due_date\"\r\n            v-model=\"due_date\"\r\n            />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"price\">折扣百分比</label>\r\n            <input\r\n              type=\"number\"\r\n              class=\"form-control\"\r\n              id=\"price\"\r\n              min=\"0\"\r\n              v-model.number=\"tempCoupon.percent\"\r\n              placeholder=\"請輸入折扣百分比\"\r\n            />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <div class=\"form-check\">\r\n              <input\r\n                class=\"form-check-input\"\r\n                type=\"checkbox\"\r\n                v-model=\"tempCoupon.is_enabled\"\r\n                :true-value=\"1\"\r\n                :false-value=\"0\"\r\n                id=\"is_enabled\"\r\n              />\r\n              <label class=\"form-check-label\" for=\"is_enabled\"> 是否啟用 </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\r\n            取消\r\n          </button>\r\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"$emit('update-coupon', tempCoupon)\">更新優惠券</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport modalMixin from '@/mixins/modal'\r\nexport default {\r\n  props: ['data', 'isNew'],\r\n  data () {\r\n    return {\r\n      tempCoupon: {},\r\n      due_date: ''\r\n    }\r\n  },\r\n  watch: {\r\n    data () {\r\n      this.tempCoupon = this.data\r\n      this.due_date = new Date(this.tempCoupon.due_date * 1000).toLocaleDateString()\r\n    },\r\n    due_date () {\r\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000)\r\n    }\r\n  },\r\n  mixins: [modalMixin]\r\n}\r\n</script>\r\n","import { render } from \"./CouponModal.vue?vue&type=template&id=159a5eb6\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupon.vue?vue&type=template&id=5f93fedc\"\nimport script from \"./Coupon.vue?vue&type=script&lang=js\"\nexport * from \"./Coupon.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}