(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fccc"],{b4bf:function(e,t,o){"use strict";o.r(t);var c=o("7a23"),a={class:"DashMain"},n={class:"container"},d={class:"text-end"},l={class:"table-responsive"},s={class:"table table-success table-striped table-hover mt-3"},r=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",null,"名稱"),Object(c["createVNode"])("th",null,"折扣百分比"),Object(c["createVNode"])("th",null,"到期日"),Object(c["createVNode"])("th",null,"是否啟用"),Object(c["createVNode"])("th",{class:"text-center"},"編輯")])],-1),i={key:0,class:"text-success fw-bold"},u={key:1,class:"text-danger fw-bold"},p={class:"text-center"},b={class:"btn-group"},j=Object(c["createTextVNode"])("> ");function O(e,t,o,O,m,h){var f=Object(c["resolveComponent"])("couponModal"),N=Object(c["resolveComponent"])("delModal");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("div",n,[Object(c["createVNode"])("div",d,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-primary mt-5",onClick:t[1]||(t[1]=function(e){return h.openModal(!0)})},"新增優惠卷")]),Object(c["createVNode"])("div",l,[Object(c["createVNode"])("table",s,[r,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(m.coupons,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:t.id},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.title),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.percent)+"%",1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.date(t.due_date)),1),Object(c["createVNode"])("td",null,[1===t.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("span",i,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("span",u,"停用"))]),Object(c["createVNode"])("td",p,[Object(c["createVNode"])("div",b,[Object(c["createVNode"])("button",{class:"btn btn-secondary",onClick:function(e){return h.openModal(!1,t)}},"編輯",8,["onClick"]),Object(c["createVNode"])("button",{class:"btn btn-danger",onClick:function(e){return h.delModal(t)}},"刪除",8,["onClick"])])])])})),128))])])])]),Object(c["createVNode"])(f,{ref:"couponModal",data:m.tempCoupon,onUpdateCoupon:h.updateCoupon,isNew:m.isNew},null,8,["data","onUpdateCoupon","isNew"]),Object(c["createVNode"])(N,{ref:"dcModal",data:m.tempCoupon,onUpdateDelete:h.updateDelete},null,8,["data","onUpdateDelete"])]),j],64)}var m=o("5530"),h=(o("99af"),{class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"}),f={class:"modal-dialog",role:"document"},N={class:"modal-content"},V={class:"modal-header bg-primary text-white"},v=Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},null,-1),C={key:0},k={key:1},M=Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),w={class:"modal-body"},y={class:"mb-3"},g=Object(c["createVNode"])("label",{for:"title"},"標題",-1),x={class:"mb-3"},_=Object(c["createVNode"])("label",{for:"coupon_code"},"優惠碼",-1),D={class:"mb-3"},B=Object(c["createVNode"])("label",{for:"due_date"},"到期日",-1),U={class:"mb-3"},$=Object(c["createVNode"])("label",{for:"price"},"折扣百分比",-1),T={class:"mb-3"},L={class:"form-check"},S=Object(c["createVNode"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),F={class:"modal-footer"},J=Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function q(e,t,o,a,n,d){return Object(c["openBlock"])(),Object(c["createBlock"])("div",h,[Object(c["createVNode"])("div",f,[Object(c["createVNode"])("div",N,[Object(c["createVNode"])("div",V,[v,o.isNew?(Object(c["openBlock"])(),Object(c["createBlock"])("span",C,"新增優惠券")):(Object(c["openBlock"])(),Object(c["createBlock"])("span",k,"編輯優惠券")),M]),Object(c["createVNode"])("div",w,[Object(c["createVNode"])("div",y,[g,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[1]||(t[1]=function(e){return n.tempCoupon.title=e})},null,512),[[c["vModelText"],n.tempCoupon.title]])]),Object(c["createVNode"])("div",x,[_,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=function(e){return n.tempCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[c["vModelText"],n.tempCoupon.code]])]),Object(c["createVNode"])("div",D,[B,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=function(e){return n.due_date=e})},null,512),[[c["vModelText"],n.due_date]])]),Object(c["createVNode"])("div",U,[$,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[4]||(t[4]=function(e){return n.tempCoupon.percent=e}),placeholder:"請輸入折扣百分比"},null,512),[[c["vModelText"],n.tempCoupon.percent,void 0,{number:!0}]])]),Object(c["createVNode"])("div",T,[Object(c["createVNode"])("div",L,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=function(e){return n.tempCoupon.is_enabled=e}),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[c["vModelCheckbox"],n.tempCoupon.is_enabled]]),S])])]),Object(c["createVNode"])("div",F,[J,Object(c["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=function(t){return e.$emit("update-coupon",n.tempCoupon)})},"更新優惠券")])])])],512)}var z=o("9641"),A={props:["data","isNew"],data:function(){return{tempCoupon:{},due_date:""}},watch:{data:function(){this.tempCoupon=this.data,this.due_date=new Date(1e3*this.tempCoupon.due_date).toLocaleDateString()},due_date:function(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[z["a"]]};A.render=q;var E=A,G=o("6ff1"),H={data:function(){return{coupons:[],tempCoupon:{},isNew:!1}},components:{couponModal:E,delModal:G["a"]},methods:{getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jamestsai","/admin/coupons?").concat(t);this.$http.get(o).then((function(t){t.data.success&&(e.coupons=t.data.coupons)}))},openModal:function(e,t){this.isNew=e,this.tempCoupon=e?{due_date:Math.floor(Date.now()/1e3),is_enabled:0,percent:100}:Object(m["a"])({},t),this.$refs.couponModal.openModal()},updateCoupon:function(e){var t=this,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jamestsai","/admin/coupon"),c="post";this.isNew||(c="put",o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jamestsai","/admin/coupon/").concat(e.id)),this.$http[c](o,{data:e}).then((function(e){e.data.success?(alert(e.data.message),t.getCoupons(),t.$refs.couponModal.hideModal()):alert(e.data.message)})).catch((function(e){console.log(e)}))},delModal:function(e){this.tempCoupon=Object(m["a"])({},e),this.$refs.dcModal.openModal()},updateDelete:function(e){var t=this,o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jamestsai","/admin/coupon/").concat(e);this.$http.delete(o).then((function(e){e.data.success?(alert(e.data.message),t.getCoupons(),t.$refs.dcModal.hideModal()):alert(e.data.message)})).catch((function(e){console.log(e)}))}},created:function(){this.getCoupons()}};H.render=O;t["default"]=H}}]);
//# sourceMappingURL=chunk-2d20fccc.9ab7847a.js.map